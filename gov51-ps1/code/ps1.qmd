---
title: "ps1.qmd"
format: html
editor: visual
---

Note: George said we could resubmit until Thursday, 2/12 at 11:59 PM without penalty.

#1: All Git steps completed & downloaded IPUMS data.

<https://github.com/ubpham-hash/gov51/tree/main>

```{r}
#2.1 Load the tidyverse and read in your ACS data
library(tidyverse)
library(knitr)
acs_data_2024 <- read_csv("/Users/ubpham/gov51/gov51-ps1/data/raw/acs2024.csv")
```

```{r}
#2.2 Using the IPUMS documentation (online at https://usa.ipums.org), look up what each variable in your dataset means. Pay special attention to TRANTIME (What does a value of 0 mean?) and PERWT (What does this represent?)
```

YEAR = The year for which the ACS was taken. Per the PSET, we are using only 2024 data. 

SAMPLE = This is just a special identifier for where the sample is drawn. First four digits = year of survey, two digits = sample number within that year. 

SERIAL = The household serial number for each household sampled in a particular sample (assigned the same household number across samples). 

CBSERIAL = The original identification number (SERIAL), but this time based on the Census Bureau of the USA

HHWT = The number of households are represented by a particular household in the sample (weighted sample to meet true population). 

CLUSTER = Taylor series linear approximation to correct sample design? 

STATEFIP - FIP is the Federal Information Processing Standards which has a coding scheme. STATEFIP provides the code for the state where the house is located.

GQ = Group quarter status classification for housing: households, group quarters (rooming or military barracks), or vacant.

PERNUM = What number the person is (in a specific household) based on census/survey form. 

\*\*\*PERWT = The weight that a given person in the sample represents for persons in the U.S. population (sample adjustment for weight to represent/reflect population. 

SEX - Male or female. 1 (male) 2 (female) 9 (missing/blank)

AGE - A person's age (years since birth as of their last birthday). 000 (less than 1). 001 (1 year old). 002 (2 years old), etc.

EDUC - Highest year or school or degree completed (not just attended or incomplete). 00 (N/A or no schooling). 01 (nursery to grade 4). 02 (grade 5-8). 03 (grade 9). 04 (grade 10). 05 (grade 11). 06 (grade 12). 07 (1 year of college). 08 (2 years of college). 09 (3 years of college). 10 (4 years of college). 11 (5+ years of college). 99 (missing)

EMPSTAT - Status as part of the labor force, status of employed or unemployed. 0 (N/A). 1 (employed). 2 (unemployed). 3 (not in the labor force). 9 (unknown/illegible)

INCTOT - total pre-tax income/losses via all sources in previous year (past 12 months), contemporary dollars not adjusted for inflation; 7 digit numeric code. 0000000 = none. -0000001 = net loss. 0000001 = \$1 or break even

\*\*\* TRANTIME - total amount of minutes it took for respondents to get home from work in the previous week (3 digit numeric value in minutes). 000 = N/A. otherwise, three-digit minute count

```{r}
#2.3 Create new variables from the raw IPUMS codes.

acs_data_2024 <- acs_data_2024|>
  mutate(
      #SEX
      female = if_else(SEX == 2, 1, 0),
      #EDUC
      less_than_hs = if_else (EDUC >= 0 & EDUC <=2, 1, 0),
      hs_only = if_else (EDUC >= 3 & EDUC <=5, 1, 0),
      some_college = if_else (EDUC >= 6 & EDUC <=7, 1, 0),
      college_only = if_else (EDUC >= 8 & EDUC <=10, 1, 0),
      advanced_degree = if_else (EDUC == 11, 1, 0),
      #EMPSTAT
      employed = if_else (EMPSTAT == 1, 1, 0),
      unemployed = if_else (EMPSTAT == 2, 1, 0),
      not_in_labor_force = if_else (EMPSTAT == 3, 1, 0),
      #INCTOT: Remove 999999 NA Case
      INCTOT = if_else(INCTOT == 9999999, NA, INCTOT)
  )
```

```{r}
#2.4 What could go wrong if you accidentally treated “N/A” codes as real zeros when calculating summary statistics.
```

You would accidentally be treating the codes as real data points that would be calculated within the summary statistics. For example, for someone whose age is not recorded or available in the data set, your summary statistics would also include someone who is 999 years old, which is inaccurate because a 999 code represents N/A and not a person who is 999 years old. Your mean, for one, would be overestimated, as the mean is not resistant to the high outlier.

```{r}
#2.5
# Create summary for commuters
summary_stats <- tibble(
  Variable = c(
    "Age",
    "Female",
    "Less than High School",
    "High School Only",
    "Some College",
    "College Only",
    "Advanced Degree",
    "Employed",
    "Unemployed",
    "Not in Labor Force",
    "Commute Time (mins)",
    "Total Income ($)"
    ),
  N = nrow(acs_data_2024),
  Mean = c (
    mean(acs_data_2024$AGE, na.rm = TRUE),
    mean(acs_data_2024$female, na.rm = TRUE),
    mean(acs_data_2024$less_than_hs, na.rm = TRUE),
    mean(acs_data_2024$hs_only, na.rm = TRUE),
    mean(acs_data_2024$some_college, na.rm = TRUE),
    mean(acs_data_2024$college_only, na.rm = TRUE),
    mean(acs_data_2024$advanced_degree, na.rm = TRUE),
    mean(acs_data_2024$employed, na.rm = TRUE),
    mean(acs_data_2024$unemployed, na.rm = TRUE),
    mean(acs_data_2024$not_in_labor_force, na.rm = TRUE),
    mean(acs_data_2024$TRANTIME, na.rm = TRUE),
    mean(acs_data_2024$INCTOT, na.rm = TRUE)
    ),
  Std_Dev = c (
    sd(acs_data_2024$AGE, na.rm = TRUE),
    sd(acs_data_2024$female, na.rm = TRUE),
    sd(acs_data_2024$less_than_hs, na.rm = TRUE),
    sd(acs_data_2024$hs_only, na.rm = TRUE),
    sd(acs_data_2024$some_college, na.rm = TRUE),
    sd(acs_data_2024$college_only, na.rm = TRUE),
    sd(acs_data_2024$advanced_degree, na.rm = TRUE),
    sd(acs_data_2024$employed, na.rm = TRUE),
    sd(acs_data_2024$unemployed, na.rm = TRUE),
    sd(acs_data_2024$not_in_labor_force, na.rm = TRUE),
    sd(acs_data_2024$TRANTIME, na.rm = TRUE),
    sd(acs_data_2024$INCTOT, na.rm = TRUE)
    ),
  Min = c (
    min(acs_data_2024$AGE, na.rm = TRUE),
    min(acs_data_2024$female, na.rm = TRUE),
    min(acs_data_2024$less_than_hs, na.rm = TRUE),
    min(acs_data_2024$hs_only, na.rm = TRUE),
    min(acs_data_2024$some_college, na.rm = TRUE),
    min(acs_data_2024$college_only, na.rm = TRUE),
    min(acs_data_2024$advanced_degree, na.rm = TRUE),
    min(acs_data_2024$employed, na.rm = TRUE),
    min(acs_data_2024$unemployed, na.rm = TRUE),
    min(acs_data_2024$not_in_labor_force, na.rm = TRUE),
    min(acs_data_2024$TRANTIME, na.rm = TRUE),
    min(acs_data_2024$INCTOT, na.rm = TRUE)
  ),
  Max = c(
    max(acs_data_2024$AGE, na.rm = TRUE),
    max(acs_data_2024$female, na.rm = TRUE),
    max(acs_data_2024$less_than_hs, na.rm = TRUE),
    max(acs_data_2024$hs_only, na.rm = TRUE),
    max(acs_data_2024$some_college, na.rm = TRUE),
    max(acs_data_2024$college_only, na.rm = TRUE),
    max(acs_data_2024$advanced_degree, na.rm = TRUE),
    max(acs_data_2024$employed, na.rm = TRUE),
    max(acs_data_2024$unemployed, na.rm = TRUE),
    max(acs_data_2024$not_in_labor_force, na.rm = TRUE),
    max(acs_data_2024$TRANTIME, na.rm = TRUE),
    max(acs_data_2024$INCTOT, na.rm = TRUE)
    ),
  )

# Turn your summary into a nice table
summary_stats |>
  kable(
    col.names = c("Variable","N", "Mean","Std_Dev","Min","Max"),
    digits = 2,
    caption = "Table 1: Summary Statistics for 2024 ACS Sample",
    )
```

```{r}
#2.6 Does the maximum commute time make sense for a daily commute? Write 1–2 sentences.
```

While I do feel bad for the person who has to make a 195 minutes daily commute (over 3 hours), it possible if they have to commute on the freeway every single day, especially during rush hours and the freeway is prone to accidents. It is still a reasonable amount of total commute time; something that would be more unlikely is over half or a fourth of the day, where a person would be choosing a job that is extremely far away and impractical.

```{r}
#3.1 How many people have TRANTIME == 0? What percentage is this?

zero_travel_count <- sum(acs_data_2024$TRANTIME == 0, na.rm = TRUE)
zero_travel_percent <- zero_travel_count / sum(!is.na(acs_data_2024$AGE)) * 100

zero_travel_count
zero_travel_percent
```

```{r}
# Who are these people with zero commute time? (Think about what categories of people wouldn’t have a commute.)

zero_commute <- acs_data_2024 |> filter(TRANTIME == 0)
zero_commute |> 
  summarise(
    employed = mean(employed, na.rm = TRUE),
    unemployed = mean(unemployed, na.rm = TRUE),
    not_in_labor_force = mean(not_in_labor_force, na.rm = TRUE)
  )
```

Employed, unemployed, and not_in_labor_force are currently coded as boolean/binary (0 or 1). The closer to 1, the higher proportion of people in that specific categorical employment variable also have a 0 minute comute time category. Employed = 0.1202543. Unemployed = 0.03505. Not in labor force = 0.5781317.

Therefore, the people with zero commute time typically include people who are unemployed (either don't have a job or still seeking employment, so they don't need to travel) and also include those not in the labor force (such asstudents who are still in school and don't have a job). It can also include employed people who are currently working from home (so they don't have to commute to work at all), so some of them can have zero commute time.

```{r}
#3.2 Create a subset called commuters that includes only people who should be in your commute time analysis. Write 2–3 sentences explaining your criteria and why.

commuters <- acs_data_2024 %>%
  filter (TRANTIME > 0, employed == 1)
```

We only want to examine commuters who actually are travelling in a typical week. People who are not employed or not in the labor force are likely to not be commuting to work because they do not have a job; therefore, we only want people who are commuting to be in this set. People who are employed may also be working from home or virtually, so we want to only include people who have to travel and commute for work (even if they have a job).

```{r}
#3.3 Verify your subset.
# Number of observations.

people_commute <- sum(!is.na(commuters$AGE))
people_commute

# Minimum commute time.

min_commute <- min(commuters$TRANTIME, na.rm = TRUE)
min_commute
```

This new minimum TRANTIME of one minute makes sense because it's non-zero (which we excluded because we only wanted people who had a non-zero commute time), and someone may possibly live extremely close to their work and commute in a very short amount of time. Perhaps a good day without traffic and only green lights.

```{r}
#3.4 Create a new summary statistics table for your commuters subset, using the same format as your table in Section 2. This lets you compare the full sample to your analytical sample.

summary_stats <- tibble(
  Variable = c(
    "Age",
    "Female",
    "Less than High School",
    "High School Only",
    "Some College",
    "College Only",
    "Advanced Degree",
    "Employed",
    "Unemployed",
    "Not in Labor Force",
    "Commute Time (mins)",
    "Total Income ($)"
    ),
  N = nrow(commuters),
  Mean = c (
    mean(commuters$AGE, na.rm = TRUE),
    mean(commuters$female, na.rm = TRUE),
    mean(commuters$less_than_hs, na.rm = TRUE),
    mean(commuters$hs_only, na.rm = TRUE),
    mean(commuters$some_college, na.rm = TRUE),
    mean(commuters$college_only, na.rm = TRUE),
    mean(commuters$advanced_degree, na.rm = TRUE),
    mean(commuters$employed, na.rm = TRUE),
    mean(commuters$unemployed, na.rm = TRUE),
    mean(commuters$not_in_labor_force, na.rm = TRUE),
    mean(commuters$TRANTIME, na.rm = TRUE),
    mean(commuters$INCTOT, na.rm = TRUE)
    ),
  Std_Dev = c (
    sd(commuters$AGE, na.rm = TRUE),
    sd(commuters$female, na.rm = TRUE),
    sd(commuters$less_than_hs, na.rm = TRUE),
    sd(commuters$hs_only, na.rm = TRUE),
    sd(commuters$some_college, na.rm = TRUE),
    sd(commuters$college_only, na.rm = TRUE),
    sd(commuters$advanced_degree, na.rm = TRUE),
    sd(commuters$employed, na.rm = TRUE),
    sd(commuters$unemployed, na.rm = TRUE),
    sd(commuters$not_in_labor_force, na.rm = TRUE),
    sd(commuters$TRANTIME, na.rm = TRUE),
    sd(commuters$INCTOT, na.rm = TRUE)
    ),
  Min = c (
    min(commuters$AGE, na.rm = TRUE),
    min(commuters$female, na.rm = TRUE),
    min(commuters$less_than_hs, na.rm = TRUE),
    min(commuters$hs_only, na.rm = TRUE),
    min(commuters$some_college, na.rm = TRUE),
    min(commuters$college_only, na.rm = TRUE),
    min(commuters$advanced_degree, na.rm = TRUE),
    min(commuters$employed, na.rm = TRUE),
    min(commuters$unemployed, na.rm = TRUE),
    min(commuters$not_in_labor_force, na.rm = TRUE),
    min(commuters$TRANTIME, na.rm = TRUE),
    min(commuters$INCTOT, na.rm = TRUE)
  ),
  Max = c(
    max(commuters$AGE, na.rm = TRUE),
    max(commuters$female, na.rm = TRUE),
    max(commuters$less_than_hs, na.rm = TRUE),
    max(commuters$hs_only, na.rm = TRUE),
    max(commuters$some_college, na.rm = TRUE),
    max(commuters$college_only, na.rm = TRUE),
    max(commuters$advanced_degree, na.rm = TRUE),
    max(commuters$employed, na.rm = TRUE),
    max(commuters$unemployed, na.rm = TRUE),
    max(commuters$not_in_labor_force, na.rm = TRUE),
    max(commuters$TRANTIME, na.rm = TRUE),
    max(commuters$INCTOT, na.rm = TRUE)
    ),
  )

# Turn your summary into a nice table
summary_stats |>
  kable(
    col.names = c("Variable","N", "Mean","Std_Dev","Min","Max"),
    digits = 2,
    caption = "Table 2: For True Commuters — Summary Statistics for 2024 ACS Sample",
    )
```

```{r}
 #4.1 Create a histogram of commute times using ggplot2.
p <- ggplot (commuters,aes(x = TRANTIME))+
  geom_histogram(
    binwidth = 10 , # Each bin = 10 minutes
    fill = "#4299E1", # Bar color
    color = "white" # Bar outline
  ) + 
  labs(
    title = "Distribution of Commute Times For Commuting, Employed Workers via 2024 ACS Sample",
    x = "Commute Time ( minutes )",
    y = "Number of Workers "
    ) +
  theme_minimal ()

p
```

```{r}
#4.2 In 2–3 sentences, describe what you see: Is it symmetric or skewed? Where is the center? Are there any notable features (e.g., spikes at certain values)?
```

The distribution of commute times is unimodal and right-skewed. It is not roughly symmetric, and the center is at approximately from 10 to 20 minutes, where there is a noticeable spike. There are possible outliers at 130-150 minutes. The spread is also approximately 150 minutes.

```{r}
# 4.3 Using your summary statistics table from Section 3, compare the mean and median commute time. Which is larger? What does this tell you about the shape of the distribution, and does it match what you see in the histogram?

median_commute <- median(commuters$TRANTIME, na.rm = TRUE)
median_commute 
```

The median commute time is 20 minutes. The mean commute time is 27.22 minutes. This means the mean is larger; this tells me that the shape of the distribution is right-skewed. It does match what I see in the histogram. This is because the median is more resistant to high outliers compared to the mean; the mean is less resistant and is more affected by higher outliers, resulting in the higher mean.

```{r}
#4.4 Save your histogram to output/commute histogram.png using ggsave().

ggsave("../output/commute_histogram.png", p,
       width = 8, height = 5)
```

```{r}
#5.1  Calculate the weighted mean:
weighted_mean <- weighted.mean(commuters$TRANTIME,commuters$PERWT)
weighted_mean
```

```{r}
#5.2 Compare: Is the weighted mean different from the unweighted mean you calculated earlier? By how much?
```

The weighted mean is 27.19112 minutes of commute. The unweighted mean is 27.22 is minutes of commute. The difference is 0.02888 minutes, and the unweighted mean is greater.

```{r}
#5.3 In 2–3 sentences, explain what each number represents and why they might differ.
```

The unweighted mean is calculated by taking the sum of all the commute times of all the workers IN THE ACS SAMPLE (who apply to the commute group, also known as employed and have a non-zero commute time) and dividing it by the number of workers for which this condition applies. The weighted mean is an estimation of the average commute time that has been scaled to reflect the total United States population (beyond the sample), including adjustments (survey weights) for smaller groups left out of the sample. The sample is only a selection of people from the entire population of the United States, meaning that although the means are largely similar, they are still different due to the inability of the sample to accurately reflect and represent every single member of the population.
